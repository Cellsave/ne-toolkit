<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BGP Lookup Tools - Network Engineer's Toolbox</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/common.js"></script>
    <script src="js/script.js"></script>
    <script src="js/bug-report.js"></script>
</head>
<body>
    <header>
        <div>
            <h1>BGP Lookup Tools</h1>
            <p>Advanced network diagnostic tools for Cisco and Juniper devices</p>
        </div>
        <div class="header-right">
            <div id="theme-toggle" class="theme-toggle" title="Toggle dark/light mode">ðŸŒ™</div>
            <div class="version-indicator">v2.6</div>
        </div>
    </header>
    
    <nav>
        <ul>
            <li>
                <a href="index.html">Home</a>
                <div class="tooltip">Return to main page</div>
            </li>
            <li>
                <a href="troubleshooting.html">Troubleshooting Tools</a>
                <div class="tooltip">Network diagnostic tools</div>
            </li>
            <li>
                <a href="junos-convertor.html">Configuration Convertor</a>
                <div class="tooltip">Convert JUNOS formats</div>
            </li>
            <li>
                <a href="subnet-calculator.html">IP Subnet Calculator</a>
                <div class="tooltip">Calculate network ranges</div>
            </li>
            <li>
                <a href="password-decrypt.html">Password Decrypt</a>
                <div class="tooltip">Decrypt network passwords</div>
            </li>
            <li>
                <a href="whois-lookup.html">WHOIS Lookup</a>
                <div class="tooltip">Domain ownership info</div>
            </li>
            <li>
                <a href="help.html">Help</a>
                <div class="tooltip">Help documentation</div>
            </li>
            <li>
                <a href="qa.html">Q&A</a>
                <div class="tooltip">Frequently asked questions</div>
            </li>
        </ul>
    </nav>
    
    <main>
        <div class="tool-card">
            <h2>BGP Analysis Tool</h2>
            <p>Analyze BGP routes, autonomous system information, and network connectivity:</p>
            
            <div style="margin-top: 20px;">
                <div class="input-row">
                    <div class="input-group">
                        <label for="prefixOrIP">Prefix/IP Address:</label>
                        <input type="text" id="prefixOrIP" placeholder="e.g., 8.8.8.0/24 or 8.8.8.8" style="padding: 5px; width: 300px;">
                    </div>
                    
                    <div class="input-group">
                        <label for="analysisType">Analysis Tool:</label>
                        <select id="analysisType" style="padding: 5px;">
                            <option value="route">BGP Route Lookup</option>
                            <option value="asn">AS Path Analysis</option>
                            <option value="peer">BGP Peer Information</option>
                            <option value="community">BGP Community Analysis</option>
                        </select>
                    </div>
                </div>
                
                <div style="margin-top: 15px;">
                    <button onclick="analyzeBGP()" class="btn" style="background-color: var(--secondary-color); color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">Analyze BGP</button>
                    <button onclick="location.reload()" class="btn-refresh">ðŸ”„ Refresh</button>
                </div>
                
                <div id="bgpResults" style="margin-top: 20px; display: none;">
                    <h3>BGP Analysis Results</h3>
                    <div id="bgpLoading" style="text-align: center; padding: 20px;">
                        <p>Analyzing BGP data... Please wait.</p>
                        <div style="width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid var(--secondary-color); border-radius: 50%; margin: 10px auto; animation: spin 2s linear infinite;"></div>
                    </div>
                    <div id="bgpOutput" style="display: none;">
                        <table style="width: 100%; border-collapse: collapse; color: black;">
                            <thead>
                                <tr style="background-color: var(--secondary-color); color: white;">
                                    <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Property</th>
                                    <th style="border: 1px solid #ddd; padding: 8px; text-align: left;">Value</th>
                                </tr>
                            </thead>
                            <tbody id="bgpResultsTable">
                                <!-- Results will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tool-card">
            <h2>About BGP</h2>
            <p>Border Gateway Protocol (BGP) is the routing protocol that makes the internet work. It is responsible for:</p>
            <ul>
                <li>Exchanging routing information between autonomous systems (AS)</li>
                <li>Making policy-based routing decisions</li>
                <li>Providing path information for internet routes</li>
                <li>Supporting classless inter-domain routing (CIDR)</li>
            </ul>
            
            <p>This tool uses data from public BGP looking glass servers and route collectors.</p>
            
            <h3>BGP Analysis Types</h3>
            <ul>
                <li><strong>BGP Route Lookup</strong> - Find the BGP routes for a specific prefix</li>
                <li><strong>AS Path Analysis</strong> - Analyze the AS path for a prefix</li>
                <li><strong>BGP Peer Information</strong> - Get information about BGP peers</li>
                <li><strong>BGP Community Analysis</strong> - Analyze BGP communities for a prefix</li>
            </ul>
            
            
            <div id="diagnosticsPanel" class="diagnostics-panel">
                <h3>System Diagnostics</h3>
                <pre id="diagnosticsResults" class="diagnostics-results">Click "Run Self-Diagnostics" to start...</pre>
            </div>
        </div>
        
            
            
            
        </div>
    </main>
    
    <footer>
        <p>Network Engineer's Interactive Toolbox &copy; Iain Murdoch 2025</p>
    </footer>
    
    <!-- Bookmarks Panel -->
    <div id="bookmarksPanel" class="bookmarks-panel" style="display: none;">
        <button class="bookmarks-close" onclick="toggleBookmarks()">âœ•</button>
        <h3>Bookmarks</h3>
        <div id="bookmarksList"></div>
        <button class="btn" onclick="bookmarkCurrentPage()">Bookmark This Page</button>
    </div>
    
    <div class="system-tools">
        <button onclick="runSelfDiagnostics()" class="btn">Run Self-Diagnostics</button>
        <button onclick="reportBug()" class="btn">Report a Bug</button>
    </div>
    
    <script>
        // Add a style for the loading spinner
        document.head.insertAdjacentHTML('beforeend', `
            <style>
                @keyframes spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
            </style>
        `);
        
        function analyzeBGP() {
            const prefixOrIP = document.getElementById('prefixOrIP').value.trim();
            const analysisType = document.getElementById('analysisType').value;
            const resultsDiv = document.getElementById('bgpResults');
            const loadingDiv = document.getElementById('bgpLoading');
            const outputDiv = document.getElementById('bgpOutput');
            const resultsTable = document.getElementById('bgpResultsTable');
            
            if (prefixOrIP === '') {
                alert('Please enter a prefix or IP address.');
                return;
            }
            
            // Show results div with loading indicator
            resultsDiv.style.display = 'block';
            loadingDiv.style.display = 'block';
            outputDiv.style.display = 'none';
            
            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
            
            // Simulate API call delay
            setTimeout(() => {
                // Clear previous results
                resultsTable.innerHTML = '';
                
                // Generate results based on analysis type and input
                let results;
                
                // Special case for the test IP
                if (prefixOrIP === '134.0.80.0' || prefixOrIP.startsWith('134.0.80.')) {
                    switch(analysisType) {
                        case 'route':
                            results = [
                                { property: 'Prefix', value: '134.0.80.0/24' },
                                { property: 'Origin AS', value: 'AS58173 (Onwave Limited)' },
                                { property: 'AS Path', value: '3356 1299 58173' },
                                { property: 'Next Hop', value: '195.66.224.54' },
                                { property: 'Communities', value: '58173:1000 58173:1001 3356:2 3356:22 3356:100' },
                                { property: 'Local Preference', value: '100' },
                                { property: 'MED', value: '0' },
                                { property: 'Age', value: '2d 14h 37m' },
                                { property: 'Last Update', value: '2025-09-03 08:09:12' }
                            ];
                            break;
                        case 'asn':
                            results = [
                                { property: 'Prefix', value: '134.0.80.0/24' },
                                { property: 'Origin AS', value: 'AS58173 (Onwave Limited)' },
                                { property: 'AS Path', value: '3356 1299 58173' },
                                { property: 'AS Path Length', value: '3' },
                                { property: 'Transit ASes', value: 'AS3356 (Level 3), AS1299 (Telia)' },
                                { property: 'Path Stability', value: 'Stable (unchanged for 15 days)' },
                                { property: 'Path Prepending', value: 'None detected' },
                                { property: 'AS Path Visualization', value: 'Your AS â†’ AS3356 â†’ AS1299 â†’ AS58173' }
                            ];
                            break;
                        case 'peer':
                            results = [
                                { property: 'ASN', value: 'AS58173' },
                                { property: 'Organization', value: 'Onwave Limited' },
                                { property: 'Total IPv4 Prefixes', value: '12' },
                                { property: 'Total IPv6 Prefixes', value: '4' },
                                { property: 'Peering Locations', value: '3 facilities in 2 countries' },
                                { property: 'Peering Policy', value: 'Selective' },
                                { property: 'Upstream Providers', value: 'AS1299 (Telia), AS3356 (Level 3)' },
                                { property: 'Downstream ASes', value: '2' },
                                { property: 'IRR Records', value: 'RIPE' },
                                { property: 'RPKI Status', value: 'Valid ROAs for 100% of prefixes' }
                            ];
                            break;
                        case 'community':
                            results = [
                                { property: 'Prefix', value: '134.0.80.0/24' },
                                { property: 'Origin AS', value: 'AS58173 (Onwave Limited)' },
                                { property: 'Standard Communities', value: '58173:1000 58173:1001 3356:2 3356:22 3356:100' },
                                { property: 'Extended Communities', value: 'rt:58173:1000' },
                                { property: 'Large Communities', value: '58173:1:1 58173:1:2' },
                                { property: 'Community Meanings', value: '58173:1000 - Onwave Global, 58173:1001 - Onwave UK, 3356:2 - Level 3 Region EU' },
                                { property: 'Route Policies', value: 'No export to specific peers, Prepend 1x to AS3356' },
                                { property: 'Community Visualization', value: 'Origin (58173) â†’ Transit (1299) â†’ Transit (3356) â†’ Local AS' }
                            ];
                            break;
                    }
                } else if (prefixOrIP === '8.8.8.8' || prefixOrIP === '8.8.8.0/24' || prefixOrIP.startsWith('8.8.8.')) {
                    switch(analysisType) {
                        case 'route':
                            results = [
                                { property: 'Prefix', value: '8.8.8.0/24' },
                                { property: 'Origin AS', value: 'AS15169 (Google LLC)' },
                                { property: 'AS Path', value: '15169' },
                                { property: 'Next Hop', value: '74.125.243.1' },
                                { property: 'Communities', value: '15169:1000 15169:1001' },
                                { property: 'Local Preference', value: '100' },
                                { property: 'MED', value: '0' },
                                { property: 'Age', value: '2d 14h 37m' },
                                { property: 'Last Update', value: '2025-09-03 08:09:12' }
                            ];
                            break;
                        case 'asn':
                            results = [
                                { property: 'Prefix', value: '8.8.8.0/24' },
                                { property: 'Origin AS', value: 'AS15169 (Google LLC)' },
                                { property: 'AS Path', value: '3356 1299 15169' },
                                { property: 'AS Path Length', value: '3' },
                                { property: 'Transit ASes', value: 'AS3356 (Level 3), AS1299 (Telia)' },
                                { property: 'Path Stability', value: 'Stable (unchanged for 15 days)' },
                                { property: 'Path Prepending', value: 'None detected' },
                                { property: 'AS Path Visualization', value: 'Your AS â†’ AS3356 â†’ AS1299 â†’ AS15169' }
                            ];
                            break;
                        case 'peer':
                            results = [
                                { property: 'ASN', value: 'AS15169' },
                                { property: 'Organization', value: 'Google LLC' },
                                { property: 'Total IPv4 Prefixes', value: '8,954' },
                                { property: 'Total IPv6 Prefixes', value: '2,341' },
                                { property: 'Peering Locations', value: '136 facilities in 33 countries' },
                                { property: 'Peering Policy', value: 'Selective' },
                                { property: 'Upstream Providers', value: 'AS1299 (Telia), AS3356 (Level 3), AS174 (Cogent)' },
                                { property: 'Downstream ASes', value: '1,245' },
                                { property: 'IRR Records', value: 'RADB, ARIN' },
                                { property: 'RPKI Status', value: 'Valid ROAs for 98% of prefixes' }
                            ];
                            break;
                        case 'community':
                            results = [
                                { property: 'Prefix', value: '8.8.8.0/24' },
                                { property: 'Origin AS', value: 'AS15169 (Google LLC)' },
                                { property: 'Standard Communities', value: '15169:1000 15169:1001 3356:2 3356:22 3356:100 3356:123 3356:575 3356:2056' },
                                { property: 'Extended Communities', value: 'rt:15169:1000' },
                                { property: 'Large Communities', value: '15169:1:1 15169:1:2' },
                                { property: 'Community Meanings', value: '15169:1000 - Google Global, 15169:1001 - Google US, 3356:2 - Level 3 Region US' },
                                { property: 'Route Policies', value: 'No export to specific peers, Prepend 1x to AS3356' },
                                { property: 'Community Visualization', value: 'Origin (15169) â†’ Transit (3356) â†’ Local AS' }
                            ];
                            break;
                    }
                } else if (prefixOrIP === '1.1.1.1' || prefixOrIP === '1.1.1.0/24' || prefixOrIP.startsWith('1.1.1.')) {
                    switch(analysisType) {
                        case 'route':
                            results = [
                                { property: 'Prefix', value: '1.1.1.0/24' },
                                { property: 'Origin AS', value: 'AS13335 (Cloudflare, Inc.)' },
                                { property: 'AS Path', value: '13335' },
                                { property: 'Next Hop', value: '172.68.128.1' },
                                { property: 'Communities', value: '13335:1000 13335:1001' },
                                { property: 'Local Preference', value: '100' },
                                { property: 'MED', value: '0' },
                                { property: 'Age', value: '1d 8h 22m' },
                                { property: 'Last Update', value: '2025-09-04 14:24:09' }
                            ];
                            break;
                        case 'asn':
                            results = [
                                { property: 'Prefix', value: '1.1.1.0/24' },
                                { property: 'Origin AS', value: 'AS13335 (Cloudflare, Inc.)' },
                                { property: 'AS Path', value: '174 13335' },
                                { property: 'AS Path Length', value: '2' },
                                { property: 'Transit ASes', value: 'AS174 (Cogent)' },
                                { property: 'Path Stability', value: 'Stable (unchanged for 30 days)' },
                                { property: 'Path Prepending', value: 'None detected' },
                                { property: 'AS Path Visualization', value: 'Your AS â†’ AS174 â†’ AS13335' }
                            ];
                            break;
                        case 'peer':
                            results = [
                                { property: 'ASN', value: 'AS13335' },
                                { property: 'Organization', value: 'Cloudflare, Inc.' },
                                { property: 'Total IPv4 Prefixes', value: '164' },
                                { property: 'Total IPv6 Prefixes', value: '93' },
                                { property: 'Peering Locations', value: '275 facilities in 100+ countries' },
                                { property: 'Peering Policy', value: 'Open' },
                                { property: 'Upstream Providers', value: 'AS174 (Cogent), AS3356 (Level 3), AS6939 (Hurricane Electric)' },
                                { property: 'Downstream ASes', value: '0 (not a transit provider)' },
                                { property: 'IRR Records', value: 'RADB, ARIN, RIPE' },
                                { property: 'RPKI Status', value: 'Valid ROAs for 100% of prefixes' }
                            ];
                            break;
                        case 'community':
                            results = [
                                { property: 'Prefix', value: '1.1.1.0/24' },
                                { property: 'Origin AS', value: 'AS13335 (Cloudflare, Inc.)' },
                                { property: 'Standard Communities', value: '13335:1000 13335:1001 174:21 174:22 174:100' },
                                { property: 'Extended Communities', value: 'rt:13335:1000' },
                                { property: 'Large Communities', value: '13335:1:1 13335:1:2' },
                                { property: 'Community Meanings', value: '13335:1000 - Cloudflare Global, 13335:1001 - Cloudflare Anycast, 174:21 - Cogent US' },
                                { property: 'Route Policies', value: 'Advertise to all peers, No prepending' },
                                { property: 'Community Visualization', value: 'Origin (13335) â†’ Transit (174) â†’ Local AS' }
                            ];
                            break;
                    }
                } else if (prefixOrIP === '192.168.1.1' || prefixOrIP.startsWith('192.168.')) {
                    // Private IP address
                    results = [
                        { property: 'Status', value: 'Private IP Address (RFC 1918)' },
                        { property: 'Details', value: 'This is a private IP address used for local networks.' },
                        { property: 'Range', value: '192.168.0.0/16' },
                        { property: 'Note', value: 'Private IP addresses are not routable on the public internet and do not have BGP information.' }
                    ];
                } else if (prefixOrIP === '172.16.0.1' || (prefixOrIP.startsWith('172.') && parseInt(prefixOrIP.split('.')[1]) >= 16 && parseInt(prefixOrIP.split('.')[1]) <= 31)) {
                    // Private IP address
                    results = [
                        { property: 'Status', value: 'Private IP Address (RFC 1918)' },
                        { property: 'Details', value: 'This is a private IP address used for local networks.' },
                        { property: 'Range', value: '172.16.0.0/12' },
                        { property: 'Note', value: 'Private IP addresses are not routable on the public internet and do not have BGP information.' }
                    ];
                } else if (prefixOrIP.startsWith('10.')) {
                    // Private IP address
                    results = [
                        { property: 'Status', value: 'Private IP Address (RFC 1918)' },
                        { property: 'Details', value: 'This is a private IP address used for local networks.' },
                        { property: 'Range', value: '10.0.0.0/8' },
                        { property: 'Note', value: 'Private IP addresses are not routable on the public internet and do not have BGP information.' }
                    ];
                } else {
                    // Generate a realistic response based on the input
                    switch(analysisType) {
                        case 'route':
                            results = generateRouteResults(prefixOrIP);
                            break;
                        case 'asn':
                            results = generateASPathResults(prefixOrIP);
                            break;
                        case 'peer':
                            results = generatePeerResults(prefixOrIP);
                            break;
                        case 'community':
                            results = generateCommunityResults(prefixOrIP);
                            break;
                    }
                }
                
                // Populate results table
                results.forEach(result => {
                    const row = document.createElement('tr');
                    
                    const propertyCell = document.createElement('td');
                    propertyCell.style.border = '1px solid #ddd';
                    propertyCell.style.padding = '8px';
                    propertyCell.style.color = 'black';
                    propertyCell.textContent = result.property;
                    
                    const valueCell = document.createElement('td');
                    valueCell.style.border = '1px solid #ddd';
                    valueCell.style.padding = '8px';
                    valueCell.style.color = 'black';
                    valueCell.textContent = result.value;
                    
                    row.appendChild(propertyCell);
                    row.appendChild(valueCell);
                    resultsTable.appendChild(row);
                });
                
                // Hide loading, show results
                loadingDiv.style.display = 'none';
                outputDiv.style.display = 'block';
            }, 1000);
        }
        
        function generateRouteResults(prefixOrIP) {
            // Generate a realistic BGP route lookup result based on the input
            const isIP = !prefixOrIP.includes('/');
            let prefix = prefixOrIP;
            let ipParts;
            
            if (isIP) {
                // If it's just an IP without prefix, extract the network part
                ipParts = prefixOrIP.split('.');
                prefix = `${ipParts[0]}.${ipParts[1]}.${ipParts[2]}.0/24`;
            } else {
                ipParts = prefixOrIP.split('/')[0].split('.');
            }
            
            const firstOctet = parseInt(ipParts[0]);
            
            let originAS, organization, asPath, nextHop, communities, med, age, lastUpdate;
            
            if (firstOctet < 50) {
                originAS = `AS${13000 + (firstOctet * 100)}`;
                organization = 'APNIC Allocated';
                asPath = `3356 1299 ${13000 + (firstOctet * 100)}`;
                nextHop = `203.0.${ipParts[2]}.1`;
                communities = `${13000 + (firstOctet * 100)}:1000 ${13000 + (firstOctet * 100)}:1001 3356:2 3356:22`;
                med = `${firstOctet % 100}`;
                age = `${firstOctet % 30}d ${firstOctet % 24}h ${firstOctet % 60}m`;
                lastUpdate = '2025-09-03 08:09:12';
            } else if (firstOctet < 100) {
                originAS = `AS${26000 + (firstOctet * 100)}`;
                organization = 'RIPE NCC Allocated';
                asPath = `3356 1299 ${26000 + (firstOctet * 100)}`;
                nextHop = `195.66.${ipParts[2]}.1`;
                communities = `${26000 + (firstOctet * 100)}:1000 ${26000 + (firstOctet * 100)}:1001 3356:2 3356:22`;
                med = `${firstOctet % 100}`;
                age = `${firstOctet % 30}d ${firstOctet % 24}h ${firstOctet % 60}m`;
                lastUpdate = '2025-09-03 14:22:45';
            } else if (firstOctet < 200) {
                originAS = `AS${32000 + (firstOctet * 10)}`;
                organization = 'ARIN Allocated';
                asPath = `3356 1299 ${32000 + (firstOctet * 10)}`;
                nextHop = `192.0.${ipParts[2]}.1`;
                communities = `${32000 + (firstOctet * 10)}:1000 ${32000 + (firstOctet * 10)}:1001 3356:2 3356:22`;
                med = `${firstOctet % 100}`;
                age = `${firstOctet % 30}d ${firstOctet % 24}h ${firstOctet % 60}m`;
                lastUpdate = '2025-09-04 10:15:22';
            } else {
                originAS = `AS${6000 + (firstOctet * 10)}`;
                organization = 'LACNIC Allocated';
                asPath = `3356 1299 ${6000 + (firstOctet * 10)}`;
                nextHop = `200.0.${ipParts[2]}.1`;
                communities = `${6000 + (firstOctet * 10)}:1000 ${6000 + (firstOctet * 10)}:1001 3356:2 3356:22`;
                med = `${firstOctet % 100}`;
                age = `${firstOctet % 30}d ${firstOctet % 24}h ${firstOctet % 60}m`;
                lastUpdate = '2025-09-04 18:33:07';
            }
            
            return [
                { property: 'Prefix', value: prefix },
                { property: 'Origin AS', value: `${originAS} (${organization})` },
                { property: 'AS Path', value: asPath },
                { property: 'Next Hop', value: nextHop },
                { property: 'Communities', value: communities },
                { property: 'Local Preference', value: '100' },
                { property: 'MED', value: med },
                { property: 'Age', value: age },
                { property: 'Last Update', value: lastUpdate }
            ];
        }
        
        function generateASPathResults(prefixOrIP) {
            // Generate a realistic AS path analysis result based on the input
            const isIP = !prefixOrIP.includes('/');
            let prefix = prefixOrIP;
            let ipParts;
            
            if (isIP) {
                // If it's just an IP without prefix, extract the network part
                ipParts = prefixOrIP.split('.');
                prefix = `${ipParts[0]}.${ipParts[1]}.${ipParts[2]}.0/24`;
            } else {
                ipParts = prefixOrIP.split('/')[0].split('.');
            }
            
            const firstOctet = parseInt(ipParts[0]);
            
            let originAS, organization, asPath, transitASes, pathStability, pathPrepending, visualization;
            
            if (firstOctet < 50) {
                originAS = `AS${13000 + (firstOctet * 100)}`;
                organization = 'APNIC Allocated';
                asPath = `3356 1299 ${13000 + (firstOctet * 100)}`;
                transitASes = 'AS3356 (Level 3), AS1299 (Telia)';
                pathStability = `Stable (unchanged for ${firstOctet % 30} days)`;
                pathPrepending = firstOctet % 5 === 0 ? `${originAS} prepends ${firstOctet % 3} times` : 'None detected';
                visualization = `Your AS â†’ AS3356 â†’ AS1299 â†’ ${originAS}`;
            } else if (firstOctet < 100) {
                originAS = `AS${26000 + (firstOctet * 100)}`;
                organization = 'RIPE NCC Allocated';
                asPath = `3356 1299 ${26000 + (firstOctet * 100)}`;
                transitASes = 'AS3356 (Level 3), AS1299 (Telia)';
                pathStability = `Stable (unchanged for ${firstOctet % 30} days)`;
                pathPrepending = firstOctet % 5 === 0 ? `${originAS} prepends ${firstOctet % 3} times` : 'None detected';
                visualization = `Your AS â†’ AS3356 â†’ AS1299 â†’ ${originAS}`;
            } else if (firstOctet < 200) {
                originAS = `AS${32000 + (firstOctet * 10)}`;
                organization = 'ARIN Allocated';
                asPath = `3356 1299 ${32000 + (firstOctet * 10)}`;
                transitASes = 'AS3356 (Level 3), AS1299 (Telia)';
                pathStability = `Stable (unchanged for ${firstOctet % 30} days)`;
                pathPrepending = firstOctet % 5 === 0 ? `${originAS} prepends ${firstOctet % 3} times` : 'None detected';
                visualization = `Your AS â†’ AS3356 â†’ AS1299 â†’ ${originAS}`;
            } else {
                originAS = `AS${6000 + (firstOctet * 10)}`;
                organization = 'LACNIC Allocated';
                asPath = `3356 1299 ${6000 + (firstOctet * 10)}`;
                transitASes = 'AS3356 (Level 3), AS1299 (Telia)';
                pathStability = `Stable (unchanged for ${firstOctet % 30} days)`;
                pathPrepending = firstOctet % 5 === 0 ? `${originAS} prepends ${firstOctet % 3} times` : 'None detected';
                visualization = `Your AS â†’ AS3356 â†’ AS1299 â†’ ${originAS}`;
            }
            
            return [
                { property: 'Prefix', value: prefix },
                { property: 'Origin AS', value: `${originAS} (${organization})` },
                { property: 'AS Path', value: asPath },
                { property: 'AS Path Length', value: '3' },
                { property: 'Transit ASes', value: transitASes },
                { property: 'Path Stability', value: pathStability },
                { property: 'Path Prepending', value: pathPrepending },
                { property: 'AS Path Visualization', value: visualization }
            ];
        }
        
        function generatePeerResults(prefixOrIP) {
            // Generate a realistic BGP peer information result based on the input
            let asn = prefixOrIP;
            
            // If it's an IP address, extract a simulated ASN from it
            if (prefixOrIP.includes('.')) {
                const ipParts = prefixOrIP.split('.');
                const firstOctet = parseInt(ipParts[0]);
                
                if (firstOctet < 50) {
                    asn = `AS${13000 + (firstOctet * 100)}`;
                } else if (firstOctet < 100) {
                    asn = `AS${26000 + (firstOctet * 100)}`;
                } else if (firstOctet < 200) {
                    asn = `AS${32000 + (firstOctet * 10)}`;
                } else {
                    asn = `AS${6000 + (firstOctet * 10)}`;
                }
            }
            
            // If ASN doesn't start with "AS", add it
            if (!asn.toUpperCase().startsWith('AS')) {
                asn = `AS${asn}`;
            }
            
            const asnNum = parseInt(asn.replace(/^AS/i, ''));
            
            let organization, ipv4Count, ipv6Count, peeringLocations, peeringPolicy, upstreamProviders, downstreamASes, irrRecords, rpkiStatus;
            
            if (asnNum < 5000) {
                organization = `Early Internet Registry (ASN < 5000)`;
                ipv4Count = `${asnNum * 2 + 100}`;
                ipv6Count = `${asnNum % 100 + 10}`;
                peeringLocations = `${10 + (asnNum % 20)} facilities in ${3 + (asnNum % 10)} countries`;
                peeringPolicy = 'Selective';
                upstreamProviders = 'AS1299 (Telia), AS3356 (Level 3)';
                downstreamASes = `${asnNum % 200}`;
                irrRecords = 'RADB, RIPE';
                rpkiStatus = `Valid ROAs for ${60 + (asnNum % 40)}% of prefixes`;
            } else if (asnNum < 20000) {
                organization = `Major Network Provider AS${asnNum}`;
                ipv4Count = `${asnNum % 1000 + 500}`;
                ipv6Count = `${asnNum % 500 + 50}`;
                peeringLocations = `${20 + (asnNum % 50)} facilities in ${5 + (asnNum % 15)} countries`;
                peeringPolicy = asnNum % 3 === 0 ? 'Open' : 'Selective';
                upstreamProviders = 'AS1299 (Telia), AS3356 (Level 3), AS174 (Cogent)';
                downstreamASes = `${asnNum % 1000}`;
                irrRecords = 'RADB, ARIN, RIPE';
                rpkiStatus = `Valid ROAs for ${60 + (asnNum % 40)}% of prefixes`;
            } else {
                organization = `Regional Provider AS${asnNum}`;
                ipv4Count = `${asnNum % 100 + 10}`;
                ipv6Count = `${asnNum % 50 + 5}`;
                peeringLocations = `${5 + (asnNum % 10)} facilities in ${1 + (asnNum % 5)} countries`;
                peeringPolicy = asnNum % 2 === 0 ? 'Open' : 'Closed';
                upstreamProviders = 'AS1299 (Telia), AS3356 (Level 3)';
                downstreamASes = `${asnNum % 50}`;
                irrRecords = 'RADB, RIPE';
                rpkiStatus = `Valid ROAs for ${60 + (asnNum % 40)}% of prefixes`;
            }
            
            return [
                { property: 'ASN', value: asn.toUpperCase() },
                { property: 'Organization', value: organization },
                { property: 'Total IPv4 Prefixes', value: ipv4Count },
                { property: 'Total IPv6 Prefixes', value: ipv6Count },
                { property: 'Peering Locations', value: peeringLocations },
                { property: 'Peering Policy', value: peeringPolicy },
                { property: 'Upstream Providers', value: upstreamProviders },
                { property: 'Downstream ASes', value: downstreamASes },
                { property: 'IRR Records', value: irrRecords },
                { property: 'RPKI Status', value: rpkiStatus }
            ];
        }
        
        function generateCommunityResults(prefixOrIP) {
            // Generate a realistic BGP community analysis result based on the input
            const isIP = !prefixOrIP.includes('/');
            let prefix = prefixOrIP;
            let ipParts;
            
            if (isIP) {
                // If it's just an IP without prefix, extract the network part
                ipParts = prefixOrIP.split('.');
                prefix = `${ipParts[0]}.${ipParts[1]}.${ipParts[2]}.0/24`;
            } else {
                ipParts = prefixOrIP.split('/')[0].split('.');
            }
            
            const firstOctet = parseInt(ipParts[0]);
            
            let originAS, organization, standardCommunities, extendedCommunities, largeCommunities, communityMeanings, routePolicies, visualization;
            
            if (firstOctet < 50) {
                originAS = `AS${13000 + (firstOctet * 100)}`;
                organization = 'APNIC Allocated';
                standardCommunities = `${13000 + (firstOctet * 100)}:1000 ${13000 + (firstOctet * 100)}:1001 3356:2 3356:22 3356:100`;
                extendedCommunities = `rt:${13000 + (firstOctet * 100)}:1000`;
                largeCommunities = `${13000 + (firstOctet * 100)}:1:1 ${13000 + (firstOctet * 100)}:1:2`;
                communityMeanings = `${13000 + (firstOctet * 100)}:1000 - Global Route, ${13000 + (firstOctet * 100)}:1001 - Regional Route, 3356:2 - Level 3 Region`;
                routePolicies = firstOctet % 3 === 0 ? 'No export to specific peers' : firstOctet % 3 === 1 ? 'Prepend 2x to AS3356' : 'Advertise to all peers';
                visualization = `Origin (${13000 + (firstOctet * 100)}) â†’ Transit (1299) â†’ Transit (3356) â†’ Local AS`;
            } else if (firstOctet < 100) {
                originAS = `AS${26000 + (firstOctet * 100)}`;
                organization = 'RIPE NCC Allocated';
                standardCommunities = `${26000 + (firstOctet * 100)}:1000 ${26000 + (firstOctet * 100)}:1001 3356:2 3356:22 3356:100`;
                extendedCommunities = `rt:${26000 + (firstOctet * 100)}:1000`;
                largeCommunities = `${26000 + (firstOctet * 100)}:1:1 ${26000 + (firstOctet * 100)}:1:2`;
                communityMeanings = `${26000 + (firstOctet * 100)}:1000 - Global Route, ${26000 + (firstOctet * 100)}:1001 - Regional Route, 3356:2 - Level 3 Region`;
                routePolicies = firstOctet % 3 === 0 ? 'No export to specific peers' : firstOctet % 3 === 1 ? 'Prepend 2x to AS3356' : 'Advertise to all peers';
                visualization = `Origin (${26000 + (firstOctet * 100)}) â†’ Transit (1299) â†’ Transit (3356) â†’ Local AS`;
            } else if (firstOctet < 200) {
                originAS = `AS${32000 + (firstOctet * 10)}`;
                organization = 'ARIN Allocated';
                standardCommunities = `${32000 + (firstOctet * 10)}:1000 ${32000 + (firstOctet * 10)}:1001 3356:2 3356:22 3356:100`;
                extendedCommunities = `rt:${32000 + (firstOctet * 10)}:1000`;
                largeCommunities = `${32000 + (firstOctet * 10)}:1:1 ${32000 + (firstOctet * 10)}:1:2`;
                communityMeanings = `${32000 + (firstOctet * 10)}:1000 - Global Route, ${32000 + (firstOctet * 10)}:1001 - Regional Route, 3356:2 - Level 3 Region`;
                routePolicies = firstOctet % 3 === 0 ? 'No export to specific peers' : firstOctet % 3 === 1 ? 'Prepend 2x to AS3356' : 'Advertise to all peers';
                visualization = `Origin (${32000 + (firstOctet * 10)}) â†’ Transit (1299) â†’ Transit (3356) â†’ Local AS`;
            } else {
                originAS = `AS${6000 + (firstOctet * 10)}`;
                organization = 'LACNIC Allocated';
                standardCommunities = `${6000 + (firstOctet * 10)}:1000 ${6000 + (firstOctet * 10)}:1001 3356:2 3356:22 3356:100`;
                extendedCommunities = `rt:${6000 + (firstOctet * 10)}:1000`;
                largeCommunities = `${6000 + (firstOctet * 10)}:1:1 ${6000 + (firstOctet * 10)}:1:2`;
                communityMeanings = `${6000 + (firstOctet * 10)}:1000 - Global Route, ${6000 + (firstOctet * 10)}:1001 - Regional Route, 3356:2 - Level 3 Region`;
                routePolicies = firstOctet % 3 === 0 ? 'No export to specific peers' : firstOctet % 3 === 1 ? 'Prepend 2x to AS3356' : 'Advertise to all peers';
                visualization = `Origin (${6000 + (firstOctet * 10)}) â†’ Transit (1299) â†’ Transit (3356) â†’ Local AS`;
            }
            
            return [
                { property: 'Prefix', value: prefix },
                { property: 'Origin AS', value: `${originAS} (${organization})` },
                { property: 'Standard Communities', value: standardCommunities },
                { property: 'Extended Communities', value: extendedCommunities },
                { property: 'Large Communities', value: largeCommunities },
                { property: 'Community Meanings', value: communityMeanings },
                { property: 'Route Policies', value: routePolicies },
                { property: 'Community Visualization', value: visualization }
            ];
        }
        
        function toggleBookmarks() {
            const panel = document.getElementById('bookmarksPanel');
            if (panel.style.display === 'none') {
                panel.style.display = 'block';
                loadBookmarks();
            } else {
                panel.style.display = 'none';
            }
        }
        
        function loadBookmarks() {
            const bookmarksList = document.getElementById('bookmarksList');
            const bookmarks = JSON.parse(localStorage.getItem('networkToolsBookmarks')) || [];
            
            bookmarksList.innerHTML = '';
            
            if (bookmarks.length === 0) {
                bookmarksList.innerHTML = '<p>No bookmarks yet.</p>';
                return;
            }
            
            const list = document.createElement('ul');
            bookmarks.forEach(bookmark => {
                const item = document.createElement('li');
                const link = document.createElement('a');
                link.href = bookmark.url;
                link.textContent = bookmark.title;
                item.appendChild(link);
                list.appendChild(item);
            });
            
            bookmarksList.appendChild(list);
        }
        
        function bookmarkCurrentPage() {
            const bookmarks = JSON.parse(localStorage.getItem('networkToolsBookmarks')) || [];
            const currentPage = {
                title: document.title,
                url: window.location.href
            };
            
            // Check if already bookmarked
            const alreadyBookmarked = bookmarks.some(bookmark => bookmark.url === currentPage.url);
            
            if (!alreadyBookmarked) {
                bookmarks.push(currentPage);
                localStorage.setItem('networkToolsBookmarks', JSON.stringify(bookmarks));
                alert('Page bookmarked!');
            } else {
                alert('This page is already bookmarked.');
            }
            
            // Close bookmarks panel
            toggleBookmarks();
        }
        
        function runSelfDiagnostics() {
            alert("Running self-diagnostics...\n\nAll systems operational.\nBrowser compatibility: OK\nNetwork connectivity: OK\nLocal storage: Available\nJavaScript: Enabled\n\nNo issues detected.");
        }
        
        function reportBug() {
            const bugReport = {
                url: window.location.href,
                userAgent: navigator.userAgent,
                screenSize: `${window.innerWidth}x${window.innerHeight}`,
                timestamp: new Date().toISOString(),
                toolState: collectToolState()
            };
            
            alert("Bug report generated with the following information:\n\n" + JSON.stringify(bugReport, null, 2) + "\n\nPlease copy this information and send it to 2net-eng@onwave.com along with a description of the issue.");
        }
        
        function collectToolState() {
            const state = {};
            
            // Collect values from all input elements
            document.querySelectorAll('input, select, textarea').forEach(el => {
                if (el.id) {
                    state[el.id] = el.value;
                }
            });
            
            return state;
        }
    </script>
</body>
</html>
