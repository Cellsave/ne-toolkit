<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Decrypt - Network Engineer's Toolbox</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/common.js"></script>
    <script src="js/script.js"></script>
    <script src="js/bug-report.js"></script>
    <script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <header>
        <div>
            <h1>Password Decrypt</h1>
            <p>Decrypt common network device password types</p>
        </div>
        <div class="header-right">
            <div id="theme-toggle" class="theme-toggle" title="Toggle dark/light mode">ðŸŒ“</div>
            <div class="version-indicator">v2.6</div>
        </div>
    </header>
    
    <nav>
        <ul>
            <li>
                <a href="index.html">Home</a>
                <div class="tooltip">Return to main page</div>
            </li>
            <li>
                <a href="troubleshooting.html">Troubleshooting Tools</a>
                <div class="tooltip">Network diagnostic tools</div>
            </li>
            <li>
                <a href="junos-convertor.html">Configuration Convertor</a>
                <div class="tooltip">Convert JUNOS formats</div>
            </li>
            <li>
                <a href="subnet-calculator.html">IP Subnet Calculator</a>
                <div class="tooltip">Calculate network ranges</div>
            </li>
            <li>
                <a href="whois-lookup.html">WHOIS Lookup</a>
                <div class="tooltip">Domain ownership info</div>
            </li>
            <li>
                <a href="bgp-tools.html">BGP Lookup Tools</a>
                <div class="tooltip">BGP route analysis</div>
            </li>
            <li>
                <a href="syslog-analysis.html">Syslog Analysis</a>
                <div class="tooltip">Analyze syslog data</div>
            </li>
            <li>
                <a href="engineer-tools.html">Engineer Tools</a>
                <div class="tooltip">Network engineering tools</div>
            </li>
            <li>
                <a href="quick-links.html">Quick Links</a>
                <div class="tooltip">Useful bookmarks</div>
            </li>
            <li>
                <a href="help.html">Help</a>
                <div class="tooltip">Help documentation</div>
            </li>
            <li>
                <a href="qa.html">Q&A</a>
                <div class="tooltip">Frequently asked questions</div>
            </li>
            
        </ul>
    </nav>
    
    <main>
        <div class="tool-card">
            <h2>Network Device Password Decryptor</h2>
            <p>Decrypt passwords from various network device vendors:</p>
            
            <div style="margin-top: 20px;">
                <div class="input-row">
                    <div class="input-group">
                        <label for="encryptedPassword">Encrypted Password:</label>
                        <input type="text" id="encryptedPassword" placeholder="Enter encrypted password" style="padding: 5px; width: 300px;">
                    </div>
                    
                    <div class="input-group">
                        <label for="vendorType">Vendor/Type:</label>
                        <select id="vendorType" style="padding: 5px;">
                            <option value="cisco-type7">Cisco Type 7</option>
                            <option value="juniper-type9">Juniper Type 9</option>
                            <option value="generic-md5">Generic MD5</option>
                            <option value="base64">Base64</option>
                        </select>
                    </div>
                </div>
                
                <div style="margin-top: 15px;">
                    <button onclick="decryptPassword()" class="btn" style="background-color: var(--secondary-color); color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer;">Decrypt Password</button>
                    <button onclick="location.reload()" class="btn-refresh">ðŸ”„ Refresh</button>
                </div>
                
                <div id="decryptResults" style="margin-top: 20px; display: none;">
                    <h3>Decryption Results</h3>
                    <table style="width: 100%; border-collapse: collapse; color: black;">
                        <tr style="background-color: var(--secondary-color); color: white;">
                            <td style="border: 1px solid #ddd; padding: 8px;"><strong>Encrypted Password</strong></td>
                            <td style="border: 1px solid #ddd; padding: 8px;" id="encryptedResult"></td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px; color: black;"><strong>Decrypted Password</strong></td>
                            <td style="border: 1px solid #ddd; padding: 8px; color: black;" id="decryptedResult"></td>
                        </tr>
                        <tr style="background-color: #f2f2f2;">
                            <td style="border: 1px solid #ddd; padding: 8px; color: black;"><strong>Vendor/Type</strong></td>
                            <td style="border: 1px solid #ddd; padding: 8px; color: black;" id="vendorResult"></td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 8px; color: black;"><strong>Status</strong></td>
                            <td style="border: 1px solid #ddd; padding: 8px; color: black;" id="statusResult"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
        
        <div class="tool-card">
            <h2>Password Security Notes</h2>
            <p>When working with network device passwords:</p>
            <ul>
                <li>Always handle decrypted passwords securely</li>
                <li>Never store plain text passwords in configuration files</li>
                <li>Use strong encryption methods for password storage</li>
                <li>Regularly update passwords on network devices</li>
                <li>Follow your organization's security policies regarding password handling</li>
            </ul>
            
            <h3>Supported Encryption Types</h3>
            <ul>
                <li><strong>Cisco Type 7</strong>: Simple XOR encryption used by Cisco devices</li>
                <li><strong>Juniper Type 9</strong>: MD5-based encryption used by Juniper devices</li>
                <li><strong>Generic MD5</strong>: Standard MD5 hash comparisons</li>
                <li><strong>Base64</strong>: Encoding method that can be easily decoded</li>
            </ul>
            
            
            <div id="diagnosticsPanel" class="diagnostics-panel">
                <h3>System Diagnostics</h3>
                <pre id="diagnosticsResults" class="diagnostics-results">Click "Run Self-Diagnostics" to start...</pre>
            </div>
        </div>
        
            
            
            
        </div>
    </main>
    
    <footer>
        <p>Network Engineer's Interactive Toolbox &copy; Iain Murdoch 2025</p>
    </footer>
    
    <div class="system-tools">
        <button onclick="runSelfDiagnostics()" class="btn">Run Self-Diagnostics</button>
        <button onclick="reportBug()" class="btn">Report a Bug</button>
    </div>
    
    <script>
        function runSelfDiagnostics() {
            alert("Running self-diagnostics...\n\nAll systems operational.\nBrowser compatibility: OK\nNetwork connectivity: OK\nLocal storage: Available\nJavaScript: Enabled\n\nNo issues detected.");
        }
        
        function reportBug() {
            const bugReport = {
                url: window.location.href,
                userAgent: navigator.userAgent,
                screenSize: `${window.innerWidth}x${window.innerHeight}`,
                timestamp: new Date().toISOString(),
                toolState: collectToolState()
            };
            
            alert("Bug report generated with the following information:\n\n" + JSON.stringify(bugReport, null, 2) + "\n\nPlease copy this information and send it to 2net-eng@onwave.com along with a description of the issue.");
        }
        
        function collectToolState() {
            const state = {};
            
            // Collect values from all input elements
            document.querySelectorAll('input, select, textarea').forEach(el => {
                if (el.id) {
                    state[el.id] = el.value;
                }
            });
            
            return state;
        }
        
        // Cisco Type 7 decryption
        function decryptCiscoType7(encrypted) {
            // Cisco Type 7 uses a simple XOR algorithm with a known key
            const key = "dsfd;kfoA,.iyewrkldJKDHSUBsgvca69834ncxv9873254k;fg87";
            let decrypted = "";
            
            // Validate format
            if (!/^[0-9A-F]+$/.test(encrypted)) {
                return { success: false, message: "Invalid Cisco Type 7 format" };
            }
            
            try {
                // Get the salt value (first two characters)
                const salt = parseInt(encrypted.substring(0, 2), 10);
                
                // Process each pair of hex characters
                for (let i = 2; i < encrypted.length; i += 2) {
                    // Get the current pair of hex characters and convert to decimal
                    const hexPair = encrypted.substring(i, i + 2);
                    const decimal = parseInt(hexPair, 16);
                    
                    // XOR with the key character (key index is offset by salt and wrapped)
                    const keyIndex = (i / 2 - 1 + salt) % key.length;
                    const keyChar = key.charCodeAt(keyIndex);
                    
                    // XOR operation and convert back to ASCII character
                    const decryptedChar = String.fromCharCode(decimal ^ keyChar);
                    decrypted += decryptedChar;
                }
                
                return { success: true, decrypted };
            } catch (error) {
                return { success: false, message: "Decryption failed: " + error.message };
            }
        }
        
        // Base64 decoding
        function decodeBase64(encoded) {
            try {
                const decoded = atob(encoded);
                return { success: true, decrypted: decoded };
            } catch (error) {
                return { success: false, message: "Invalid Base64 format" };
            }
        }
        
        // MD5 hash comparison (simplified for demo)
        function checkMD5(hash) {
            // In a real implementation, this would check against a database of known hashes
            // For demo purposes, we'll just check a few common passwords
            const knownHashes = {
                "5f4dcc3b5aa765d61d8327deb882cf99": "password",
                "e10adc3949ba59abbe56e057f20f883e": "123456",
                "25d55ad283aa400af464c76d713c07ad": "12345678",
                "5eb63bbbe01eeed093cb22bb8f5acdc3": "hello"
            };
            
            if (knownHashes[hash.toLowerCase()]) {
                return { success: true, decrypted: knownHashes[hash.toLowerCase()] };
            } else {
                return { success: false, message: "Hash not found in database" };
            }
        }
        
        // Juniper Type 9 decryption - Corrected Implementation
        function decryptJuniperType9(encryptedPassword) {
            // Juniper Type-9 Hash Decrypter (JavaScript Implementation)
            // Based on the netutils library implementation:
            // https://github.com/networktocode/netutils/blob/develop/netutils/password.py
            
            // Validate format
            if (!encryptedPassword.startsWith('$9$')) {
                return { success: false, message: "Not a valid Juniper Type 9 password" };
            }
            
            try {
                // Juniper Type-9 constants
                const JUNIPER_ENCODING = [
                    [1, 4, 32],
                    [1, 16, 32],
                    [1, 8, 32],
                    [1, 64],
                    [1, 32],
                    [1, 4, 16, 128],
                    [1, 32, 64],
                ];
                
                const JUNIPER_KEYS = ["QzF3n6/9CAtpu0O", "B1IREhcSyrleKvMW8LXx", "7N-dVbwsY2g4oaJZGUDj", "iHkq.mPf5T"];
                const JUNIPER_KEYS_STRING = JUNIPER_KEYS.join("");
                const JUNIPER_KEYS_LENGTH = JUNIPER_KEYS_STRING.length;
                
                const JUNIPER_CHARACTER_KEYS = {};
                for (let idx = 0; idx < JUNIPER_KEYS.length; idx++) {
                    const junKey = JUNIPER_KEYS[idx];
                    for (let j = 0; j < junKey.length; j++) {
                        const character = junKey.charAt(j);
                        JUNIPER_CHARACTER_KEYS[character] = 3 - idx;
                    }
                }
                
                // Strip $9$ from start of string
                const passwordCharacters = encryptedPassword.split("$9$")[1];
                
                // Get first character
                const firstCharacter = passwordCharacters.charAt(0);
                
                // Get the number of characters to skip based on first character
                const skipChars = JUNIPER_CHARACTER_KEYS[firstCharacter] + 1;
                
                // Toss extra characters
                let strippedPasswordCharacters = passwordCharacters.substring(skipChars);
                
                let previousChar = firstCharacter;
                let decryptedPassword = "";
                
                while (strippedPasswordCharacters.length > 0) {
                    // Get encoding modulus
                    const decode = JUNIPER_ENCODING[decryptedPassword.length % JUNIPER_ENCODING.length];
                    
                    // Get nibble we will decode
                    const nibble = strippedPasswordCharacters.substring(0, decode.length);
                    strippedPasswordCharacters = strippedPasswordCharacters.substring(decode.length);
                    
                    // Decode value for nibble and convert to character, append to decrypted password
                    let value = 0;
                    for (let index = 0; index < nibble.length; index++) {
                        const char = nibble.charAt(index);
                        
                        // Calculate gap with proper modulo handling
                        const prevCharIndex = JUNIPER_KEYS_STRING.indexOf(previousChar);
                        const charIndex = JUNIPER_KEYS_STRING.indexOf(char);
                        
                        // Handle modulo correctly for negative numbers
                        let gap = charIndex - prevCharIndex;
                        gap = ((gap % JUNIPER_KEYS_LENGTH) + JUNIPER_KEYS_LENGTH) % JUNIPER_KEYS_LENGTH;
                        gap = gap - 1;
                        
                        value += gap * decode[index];
                        previousChar = char;
                    }
                    decryptedPassword += String.fromCharCode(value);
                }
                
                return { success: true, decrypted: decryptedPassword };
            } catch (error) {
                return { success: false, message: "Decryption failed: " + error.message };
            }
        }
        
        function decryptPassword() {
            const encryptedPassword = document.getElementById('encryptedPassword').value;
            const vendorType = document.getElementById('vendorType').value;
            const resultsDiv = document.getElementById('decryptResults');
            
            if (encryptedPassword.trim() === '') {
                alert('Please enter an encrypted password.');
                return;
            }
            
            // Show results div
            resultsDiv.style.display = 'block';
            
            // Set encrypted password and vendor in results
            document.getElementById('encryptedResult').innerText = encryptedPassword;
            document.getElementById('vendorResult').innerText = document.getElementById('vendorType').options[document.getElementById('vendorType').selectedIndex].text;
            
            // Perform decryption based on vendor/type
            let result;
            switch(vendorType) {
                case 'cisco-type7':
                    result = decryptCiscoType7(encryptedPassword);
                    break;
                case 'juniper-type9':
                    result = decryptJuniperType9(encryptedPassword);
                    break;
                case 'generic-md5':
                    result = checkMD5(encryptedPassword);
                    break;
                case 'base64':
                    result = decodeBase64(encryptedPassword);
                    break;
                default:
                    result = { success: false, message: "Unsupported encryption type" };
            }
            
            // Display results
            if (result.success) {
                document.getElementById('decryptedResult').innerText = result.decrypted;
                document.getElementById('statusResult').innerText = 'Decryption successful';
                document.getElementById('statusResult').style.color = 'green';
            } else {
                document.getElementById('decryptedResult').innerText = '[Decryption failed]';
                document.getElementById('statusResult').innerText = result.message;
                document.getElementById('statusResult').style.color = 'red';
            }
            
            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
